## 完成デモ
https://first-nextjs-woad.vercel.app/

## ページ構成
<img src="https://github.com/tohda-tomohiro/first-nextjs-app/assets/154492181/f07713f3-b89f-4406-9af0-8818a95fe0a3" width="500" />

## プロジェクト作成

以下、npm 部分は各自のツール yarn , pnpm などに置き換えても問題ないです。

```bash
npx create-next-app@latest
```

![Untitled](https://github.com/tohda-tomohiro/first-nextjs-app/assets/154492181/8feebd25-636f-444d-b0e8-7f8b5f2e5578)

### Chakra UI インストール

Next.js 用のパッケージ（@chakra-ui/next-js）もインストールします。

[Getting Started with Next.js (App) - Chakra UI (chakra-ui.com)](https://chakra-ui.com/getting-started/nextjs-app-guide)

```bash
npm i @chakra-ui/react @chakra-ui/next-js @emotion/react @emotion/styled framer-motion
```

### .prettierrc ファイルの作成（自動整形ツール）

VSCode の拡張機能もインストールして有効化してください。

[Prettier - Code formatter - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode)

```bash
{
  "tabWidth": 2,
  "semi": true,
  "singleQuote": true
}
```

### 不要ファイルの削除

- app/globals.css
- app/page.module.css

<aside>
📖 app ディレクトリの初期構成

├ favicon.ico

├ layout.js

└ page.js

</aside>

### 初期ファイルの修正

app/layout.js

```jsx
export const metadata = {
  title: 'Create Next App',
  description: 'Generated by create next app',
};

export default function RootLayout({ children }) {
  return (
    <html lang="ja">
      <body>{children}</body>
    </html>
  );
}
```

app/page.js

```jsx
export default function Page() {
  return <div>Hello</div>;
}
```

### 起動確認

```bash
npm run dev
```

## レイアウト作成

### Chakra UI の準備

公式の手順通りに`Provider`を作成します。

[Getting Started with Next.js (App) - Chakra UI (chakra-ui.com)](https://chakra-ui.com/getting-started/nextjs-app-guide)

`CacheProvider` を利用すると、コンポーネントファイル内で “use client”が不要になります。

[Version 2.5.0 - Chakra UI (chakra-ui.com)](https://chakra-ui.com/changelog/v2.5.0#nextjs-201)

<aside>
📖 Provider

アプリケーション内の異なるコンポーネント間でデータを共有するための仕組みとして、React Context があります。Provider は、その Context のデータを保持し、そのデータをコンテキスト内のコンポーネントと共有するための手段です。これにより、コンポーネント間でのデータの共有が簡単になります。

<img src="https://github.com/tohda-tomohiro/first-nextjs-app/assets/154492181/b7fd0ca3-1a49-4402-907c-c3b8a573e720" width="300">

</aside>

app/providers.jsx

```jsx
'use client';
import { CacheProvider } from '@chakra-ui/next-js';
import { ChakraProvider } from '@chakra-ui/react';

export function Providers({ children }) {
  return (
    <CacheProvider>
      <ChakraProvider>{children}</ChakraProvider>
    </CacheProvider>
  );
}
```

app/layout.jsx

```jsx
import { Providers } from '@/app/providers';

export const metadata = {
  title: 'Create Next App',
  description: 'Generated by create next app',
};

export default function RootLayout({ children }) {
  return (
    <html lang="ja">
      <Providers>{children}</Providers>
    </html>
  );
}
```

app/page.jsx

明示的に JSX を返す関数コンポーネントであることを示すため、拡張子を「.jsx」に変更しています。

```jsx
import { Box } from '@chakra-ui/react';

export default function Page() {
  return <Box color="red">Hello</Box>;
}
```

### 動作確認

一度 http://localhost:3000/ で動作を確認してください。

「Hello」テキストが赤色で表示されれば OK です。

```bash
npm run dev
```

## ページ作成

Next.js（App Router）のファイルシステムベースのルーティング

- page.jsx（ .js / .tsx ）を default export しているディレクトリに基づいてルーティングがなされます。
- layout.jsx（ .js / .tsx ）は共有レイアウト・テンプレートになります。

※ Pages Router ではルールが違います。

### トップページ

| URL                      | /            |
| ------------------------ | ------------ |
| マッピング対象のファイル | app/page.jsx |

![top](https://github.com/tohda-tomohiro/first-nextjs-app/assets/154492181/6384a25c-6313-4f7f-bca4-ffe0ec8c377e)

- app/page.jsx
  ```jsx
  import { Box, Button, Heading, Center } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export default function Home() {
    return (
      <Center h="100vh" bg="gray.100">
        <Box>
          <Heading as="h1" fontSize="2xl">
            Welcome!
          </Heading>
          <Button
            as={NextLink}
            href="/main"
            colorScheme="blue"
            size="lg"
            mt="2"
          >
            Go Main.
          </Button>
        </Box>
      </Center>
    );
  }
  ```

### メインページ

| URL                      | /main             |
| ------------------------ | ----------------- |
| マッピング対象のファイル | app/main/page.jsx |

![main](https://github.com/tohda-tomohiro/first-nextjs-app/assets/154492181/4dbd03ce-a332-41e5-b4f1-952102287322)

- app/main/page.jsx
  ```jsx
  import { Container, Text, Box, Flex, Button, HStack } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export default function Main() {
    return (
      <Box minH="100dvh" bg="gray.100">
        <Box as="header" position="relative" height="50px">
          <Flex
            position="fixed"
            top="0"
            left="0"
            w="full"
            height="50px"
            zIndex="1"
            bg="white"
            py="3"
            borderBottom="1px solid"
            borderColor="gray.300"
            alignItems="center"
          >
            <Container maxW="container">
              <Flex justifyContent="space-between" alignItems="center">
                <Text fontSize="md" fontWeight="bold">
                  Next.js Frist App
                </Text>
                <HStack spacing="2">
                  <Button size="sm" variant="ghost" as={NextLink} href="/">
                    Top
                  </Button>
                  <Button size="sm" variant="ghost" as={NextLink} href="/main">
                    Main
                  </Button>
                </HStack>
              </Flex>
            </Container>
          </Flex>
        </Box>
        <Container maxW="container.md" py="4">
          <Box as="main" bg="white" px="6" py="8" rounded="lg">
            <Box fontSize="sm">コンテンツ</Box>
          </Box>
        </Container>
        <Box
          as="footer"
          position="sticky"
          top="100%"
          py="3"
          borderTop="1px solid"
          borderColor="gray.200"
          bg="white"
        >
          <Text fontSize="xs" textAlign="center">
            © 2015 StudyHacker Inc.
          </Text>
        </Box>
      </Box>
    );
  }
  ```

### プロフィールページ

| URL                      | /main/profile             |
| ------------------------ | ------------------------- |
| マッピング対象のファイル | app/main/profile/page.jsx |

https://github.com/tohda-tomohiro/first-nextjs-app/assets/154492181/80d346d0-a825-45a2-aace-b9fe90fcf0f1

1. メインページを複製し、プロフィールページを作成します。
2. メインページとプロフィールページのコンテンツを修正します。

- app/main/page.jsx
  ```jsx
  import {
    Container,
    Text,
    Box,
    Flex,
    Button,
    HStack,
    Heading,
  } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export default function Main() {
    return (
      <Box minH="100dvh" bg="gray.100">
        <Box as="header" position="relative" height="50px">
          <Flex
            position="fixed"
            top="0"
            left="0"
            w="full"
            height="50px"
            zIndex="1"
            bg="white"
            py="3"
            borderBottom="1px solid"
            borderColor="gray.300"
            alignItems="center"
          >
            <Container maxW="container">
              <Flex justifyContent="space-between" alignItems="center">
                <Text fontSize="md" fontWeight="bold">
                  Next.js Frist App
                </Text>
                <HStack spacing="2">
                  <Button size="sm" variant="ghost" as={NextLink} href="/">
                    Top
                  </Button>
                  <Button size="sm" variant="ghost" as={NextLink} href="/main">
                    Main
                  </Button>
                </HStack>
              </Flex>
            </Container>
          </Flex>
        </Box>
        <Container maxW="container.md" py="4">
          <Box as="main" bg="white" px="6" py="8" rounded="lg">
            <Heading as="h2" fontSize="2xl">
              Main
            </Heading>
            <Box fontSize="sm" my="4">
              メインページです。
            </Box>
            <Button size="sm" as={NextLink} href="/main/profile">
              プロフィールページへ
            </Button>
          </Box>
        </Container>
        <Box
          as="footer"
          position="sticky"
          top="100%"
          py="3"
          borderTop="1px solid"
          borderColor="gray.200"
          bg="white"
        >
          <Text fontSize="xs" textAlign="center">
            © 2015 StudyHacker Inc.
          </Text>
        </Box>
      </Box>
    );
  }
  ```
- app/main/profile/page.jsx
  ```jsx
  import {
    Container,
    Text,
    Box,
    Flex,
    Button,
    HStack,
    Heading,
  } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export default function Profile() {
    return (
      <Box minH="100dvh" bg="gray.100">
        <Box as="header" position="relative" height="50px">
          <Flex
            position="fixed"
            top="0"
            left="0"
            w="full"
            height="50px"
            zIndex="1"
            bg="white"
            py="3"
            borderBottom="1px solid"
            borderColor="gray.300"
            alignItems="center"
          >
            <Container maxW="container">
              <Flex justifyContent="space-between" alignItems="center">
                <Text fontSize="md" fontWeight="bold">
                  Next.js Frist App
                </Text>
                <HStack spacing="2">
                  <Button size="sm" variant="ghost" as={NextLink} href="/">
                    Top
                  </Button>
                  <Button size="sm" variant="ghost" as={NextLink} href="/main">
                    Main
                  </Button>
                </HStack>
              </Flex>
            </Container>
          </Flex>
        </Box>
        <Container maxW="container.md" py="4">
          <Box as="main" bg="white" px="6" py="8" rounded="lg">
            <Heading as="h2" fontSize="2xl">
              Profile
            </Heading>
            <Box fontSize="sm" my="4">
              プロフィールページです。
            </Box>
            <Button size="sm" as={NextLink} href="/main">
              メインページへ
            </Button>
          </Box>
        </Container>
        <Box
          as="footer"
          position="sticky"
          top="100%"
          py="3"
          borderTop="1px solid"
          borderColor="gray.200"
          bg="white"
        >
          <Text fontSize="xs" textAlign="center">
            © 2015 StudyHacker Inc.
          </Text>
        </Box>
      </Box>
    );
  }
  ```

### 共通部分のレイアウト化

![Group 13](https://github.com/tohda-tomohiro/first-nextjs-app/assets/154492181/c1813ff1-9f1b-4319-b30c-160e9d139567)

- app/main/layout.jsx
  ```jsx
  import { Container, Text, Box, Flex, Button, HStack } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export default function Layout({ children }) {
    return (
      <Box minH="100dvh" bg="gray.100">
        <Box as="header" position="relative" height="50px">
          <Flex
            position="fixed"
            top="0"
            left="0"
            w="full"
            height="50px"
            zIndex="1"
            bg="white"
            py="3"
            borderBottom="1px solid"
            borderColor="gray.300"
            alignItems="center"
          >
            <Container maxW="container">
              <Flex justifyContent="space-between" alignItems="center">
                <Text fontSize="md" fontWeight="bold">
                  Next.js Frist App
                </Text>
                <HStack spacing="2">
                  <Button size="sm" variant="ghost" as={NextLink} href="/">
                    Top
                  </Button>
                  <Button size="sm" variant="ghost" as={NextLink} href="/main">
                    Main
                  </Button>
                </HStack>
              </Flex>
            </Container>
          </Flex>
        </Box>
        <Container maxW="container.md" py="4">
          <Box as="main" bg="white" px="6" py="8" rounded="lg">
            {children}
          </Box>
        </Container>
        <Box
          as="footer"
          position="sticky"
          top="100%"
          py="3"
          borderTop="1px solid"
          borderColor="gray.200"
          bg="white"
        >
          <Text fontSize="xs" textAlign="center">
            © 2015 StudyHacker Inc.
          </Text>
        </Box>
      </Box>
    );
  }
  ```
- app/main/page.jsx
  ```jsx
  import { Box, Button, Heading } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export default function Main() {
    return (
      <>
        <Heading as="h2" fontSize="2xl">
          Main
        </Heading>
        <Box fontSize="sm" my="4">
          メインページです。
        </Box>
        <Button size="sm" as={NextLink} href="/main/profile">
          プロフィールページへ
        </Button>
      </>
    );
  }
  ```
- app/main/profile/page.jsx
  ```jsx
  import { Box, Button, Heading } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export default function Profile() {
    return (
      <>
        <Heading as="h2" fontSize="2xl">
          Profile
        </Heading>
        <Box fontSize="sm" my="4">
          プロフィールページです。
        </Box>
        <Button size="sm" as={NextLink} href="/main">
          メインページへ
        </Button>
      </>
    );
  }
  ```

### 設定ページ

| URL                      | /main/settings             |
| ------------------------ | -------------------------- |
| マッピング対象のファイル | app/main/settings/page.jsx |

「プロフィール」ページを複製して「設定」ページを作成し、「メイン」ページにリンクを設置します。

- app/main/page.jsx
  ```jsx
  import { Box, Button, Heading } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export default function Main() {
    return (
      <>
        <Heading as="h2" fontSize="2xl">
          Main
        </Heading>
        <Box fontSize="sm" my="4">
          メインページです。
        </Box>
        <Button size="sm" as={NextLink} href="/main/profile">
          プロフィールページへ
        </Button>
        <Button size="sm" as={NextLink} href="/main/settings" ml="2">
          設定ページへ
        </Button>
      </>
    );
  }
  ```
- app/main/settings/page.jsx
  ```jsx
  import { Box, Button, Heading } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export default function Settings() {
    return (
      <>
        <Heading as="h2" fontSize="2xl">
          Settings
        </Heading>
        <Box fontSize="sm" my="4">
          設定ページです。
        </Box>
        <Button size="sm" as={NextLink} href="/main">
          メインページへ
        </Button>
      </>
    );
  }
  ```

## コンポーネントの作成

\_components ディレクトリを作成し、その配下にコンポーネントをまとめます。

<aside>
📖 **app ディレクトリの構成**

├ favicon.ico

├ layout.jsx

├ page.jsx

└ /main

├ layout.jsx

├ page.jsx

├ /\_components — 新規作成

┃└ Navbar.jsx

├ /pfofile

┃└ page.jsx

└ /settings

└ page.jsx

</aside>

### ナビゲーションバー

- app/main/\_components/Navbar.jsx
  ```jsx
  import { Button, HStack } from '@chakra-ui/react';
  import NextLink from 'next/link';

  export function Navbar({ slug }) {
    return (
      <HStack spacing="3" mb="5">
        <Button
          as={NextLink}
          href="/main"
          size="xs"
          colorScheme="teal"
          variant="outline"
          isDisabled={slug === 'main'}
        >
          メイン
        </Button>
        <Button
          as={NextLink}
          href="/main/profile"
          size="xs"
          colorScheme="teal"
          variant="outline"
          isDisabled={slug === 'profile'}
        >
          プロフィール
        </Button>
        <Button
          as={NextLink}
          href="/main/settings"
          size="xs"
          colorScheme="teal"
          variant="outline"
          isDisabled={slug === 'settings'}
        >
          設定
        </Button>
      </HStack>
    );
  }
  ```
- app/main/page.jsx
  ```jsx
  import { Box, Heading } from '@chakra-ui/react';
  import { Navbar } from './_components/Navbar';

  export default function Main() {
    return (
      <>
        <Navbar slug="main" />
        <Heading as="h2" fontSize="2xl">
          Main
        </Heading>
        <Box fontSize="sm" my="4">
          メインページです。
        </Box>
      </>
    );
  }
  ```
- app/main/profile/page.jsx
  ```jsx
  import { Box, Heading } from '@chakra-ui/react';
  import { Navbar } from '../_components/Navbar';

  export default function Profile() {
    return (
      <>
        <Navbar slug="profile" />
        <Heading as="h2" fontSize="2xl">
          Profile
        </Heading>
        <Box fontSize="sm" my="4">
          プロフィールページです。
        </Box>
      </>
    );
  }
  ```
- app/main/settings/page.jsx
  ```jsx
  import { Box, Heading } from '@chakra-ui/react';
  import { Navbar } from '../_components/Navbar';

  export default function Settings() {
    return (
      <>
        <Navbar slug="settings" />
        <Heading as="h2" fontSize="2xl">
          Settings
        </Heading>
        <Box fontSize="sm" my="4">
          設定ページです。
        </Box>
      </>
    );
  }
  ```
